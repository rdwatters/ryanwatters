{% extends "templates/partials/base.html" %}
{% block crp_block %}
      <style>
          {% include "templates/partials/crp-article.html" %}
      </style>
{% endblock %}
{% block head_extra %}
  {% set prev = prevItem(item, 'publish_date', true) %}
  {% set next = nextItem(item, 'publish_date', true) %}
  {% if prev %}
    <!-- <link rel="prefetch" href="{{ url(prev) }}#main" />
    <link rel="prerender" href="{{ url(prev) }}" /> -->
  {% endif %}
  {% if next %}
   <!--  <link rel="prefetch" href="{{ url(next) }}#main" />
    <link rel="prerender" href="{{ url(next) }}" />
 -->  {% endif %}
{% endblock %}
{% block title %}{{ item.title }}{% endblock %}
{% block content %}
{% set article = item %}


{% if article.related_video %}
    {% set video = article.related_video %}
    {% set ss = video.streaming_service %}
    {% set wVideo = "w-video" %}
    {% if ss == "YouTube"%}
        {% set videoId = video.video.original_url.split('v=')[1] %}
        {% set streaming = "youtube" %}
    {% elseif ss == "Vimeo" %}
        {% set videoId = video.video.original_url.split('vimeo.com/')[1] %}
        {% set streaming = "vimeo" %}
    {% endif %}
    <section class="article-video">        
        <div class="video-player-{{streaming}}" data-{{-streaming-}}id="{{videoId}}">
                {% if video.thumbnail_override %}
                        <img class="video-thumb" src="{{ video.thumbnail_override|imageCrop(560,315)}}" alt="{{video.video_title}}" width="1080" height="630">
                {% else %}
                        <img class="video-thumb" src="{{ video.video.thumbnail_url }}" alt="{{ video.video_title}}" class="video-thumb" width="560" height="315">
                {% endif %}
            <div class="play-button" role="button">
                <svg class="play-button-svg" fill="#ffffff" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
                <path id="play-button-inner-triangle" d="M52.881,14.708c-18.9,0-34.222,15.321-34.222,34.223c0,18.901,15.322,34.221,34.222,34.221  c18.901,0,34.224-15.32,34.224-34.221C87.104,30.03,71.782,14.708,52.881,14.708z M55.883,58.107L40.02,67.226l0.035-18.294  l0.034-18.296l15.828,9.176l15.828,9.178L55.883,58.107z" /></svg>
            </div>
        </div>
        <div class="image-fade-block"></div>
    </section>
{% else %}
  <section class="article-main-image">
    <img class="main-image" src="{{ item.image|imageCrop(1000, 500)}}" />
    <span class="image-fade-block"></span>           
  </section>
{% endif %}
<article class="full-length {{wVideo}}" data-swiftype-index="true" itemscope itemtype="https://schema.org/BlogPosting">

  {% if prev %}      
      <a href="{{ url(prev) }}" role="button" class="previous-article"><!-- data-pjax -->
          <section class="article-info">
            <h5 class="previous">Previous Article</h5>
            <span class="article-title">{{prev.title}}</span>
            <span class="article-author"> by {{prev.author[0].full_name.first}} {{prev.author[0].full_name.last}}</span> 
            <span class="publish_date">{{prev.publish_date|date('M d, Y')}}</span>
          </section>
            <svg version="1.0" id="left-arrow-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="25px" height="80px"
                 viewBox="0 0 18.6 27.9" enable-background="new 0 0 18.6 27.9" xml:space="preserve">
              <g>
                <polygon points="18.6,0 9.3,0 0,14 9.3,27.9 18.6,27.9 9.3,14  "/>
              </g>
            </svg>
        </a>    
  {% endif %}
  {% if next %}
      
        <a href="{{ url(next) }}" role="button" class="next-article">
            <svg version="1.1" id="right-arrow-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="25px" height="80px"
                 viewBox="60 -17.1 35.5 53.3" enable-background="new 60 -17.1 35.5 53.3" xml:space="preserve">
              <g>
                <polygon points="60,36.2 77.8,36.2 95.6,9.5 77.8,-17.1 60,-17.1 77.8,9.5  "/>
              </g>
            </svg>
          <section class="article-info">
            <h5 class="next">Next Article</h5>
            <span class="article-title">{{next.title}}</span>
            <span class="article-author"> by {{next.author[0].full_name.first}} {{next.author[0].full_name.last}}</span> 
            <span class="publish-date">{{next.publish_date|date('M d, Y')}}</span> 
          </section>
        </a>
      
  {% endif %}
  <aside class="social-media-icons-bar" id="social-media-icons-bar" data-swiftype-index="false">  
    <div class="social-buttons">
    {% include "templates/partials/socialmediaicons.html" %}
    </div>
      <a href="#" role="button" title="Share this article through social media." class="share-button"><div class="share"> SHARE</div></a>
  </aside>
  <h1>{{ item.title }}</h1> 
  <h2 class="article-subtitle">{{ item.subtitle }}</h2>
  {% if item.most_recent_update %}
      <time class="article-publish-date" itemprop="dateModified" datetime="{{ item.most_recent_update }}">
        <span class="publish-date-updated"><strong class="updated"><small>UPDATED</small></strong> {{ item.most_recent_update|date('F d, Y') }} </span>
    </time>
  {% else %}
      <time class="article-publish-date" itemprop="datePublished" datetime="{{ item.publish_date }}"> 
      <span class="publish-date">{{ item.publish_date|date('F d, Y') }}</span>
    </time>
  {% endif %}
    {% set articleLength = item.body.split(' ') %}
    {# You can change this number. Avg wpm in the States is roughly 250-300 #}
    {% set lengthInMinutes = Math.floor(articleLength.length/275) %}            
        <p class="article-metadata" itemprop="author" itemprop="accountablePerson">by 
          {% for relation in item.author %}
            <a href="{{ url(relation) }}">
              <cite class="author-name" itemprop="author">{{ relation.name }}</cite>
            </a> &mdash;  
            {% if not loop.last %} & {% endif %}
          {% endfor %} posted in
          {% for relation in item.category %}
            <a href="{{ url(relation) }}">
              <span class="article-category" itemprop="about">{{ relation.name }}</span>
            </a>
            {% if not loop.last %} & {% endif %}
          {% endfor %}
        </p>
        <div class="length-in-minutes">
          <span class="clock-icon">
            <svg version="1.1" id="clock-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
              viewBox="-9.5 10.2 8.9 8.9" enable-background="new -9.5 10.2 8.9 8.9" xml:space="preserve" width="26px" height="26px">
              <g>
                <path d="M-5.1,19.1c2.5,0,4.4-2,4.4-4.4c0-2.5-2-4.4-4.4-4.4c-2.5,0-4.4,2-4.4,4.4C-9.5,17.1-7.5,19.1-5.1,19.1z M-5.1,11.1
                  c2,0,3.6,1.6,3.6,3.6c0,2-1.6,3.6-3.6,3.6s-3.6-1.6-3.6-3.6S-7,11.1-5.1,11.1z"/>
                <path d="M-5.5,14.8C-5.5,14.8-5.5,14.8-5.5,14.8C-5.5,14.8-5.5,14.8-5.5,14.8c0,0.1,0,0.1,0,0.1c0,0,0,0,0,0c0,0,0,0,0.1,0.1
                  c0,0,0,0,0,0l1.8,1.8c0.2,0.2,0.5,0.2,0.6,0c0.2-0.2,0.2-0.5,0-0.6l-1.6-1.6v-1.8c0-0.2-0.2-0.4-0.4-0.4c-0.2,0-0.4,0.2-0.4,0.4
                  L-5.5,14.8C-5.5,14.7-5.5,14.7-5.5,14.8z"/>
              </g>
            </svg>
          </span>
          <span class="time">{{ lengthInMinutes }}-Minute Read</span>
        </div>
        {% if article.related_video %}
        <div class="play-button-small">
          <svg class="play-button-svg-small" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="100px" height="100px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
          <path id="play-button-inner-triangle" d="M52.881,14.708c-18.9,0-34.222,15.321-34.222,34.223c0,18.901,15.322,34.221,34.222,34.221  c18.901,0,34.224-15.32,34.224-34.221C87.104,30.03,71.782,14.708,52.881,14.708z M55.883,58.107L40.02,67.226l0.035-18.294  l0.034-18.296l15.828,9.176l15.828,9.178L55.883,58.107z" /></svg>
        </div>
        {% endif %}
  {# BODY CONTENT - Markdown or RTE #}       
  <section class="body-content" data-swiftype-name="body" data-swiftype-type="text">
  {{ item.body|markdown }}
  </section>
  <ul class="article-tags" itemprop="keywords">
      {% for relation in item.tags %}
        <li class="article-tag"><a href="{{ url(relation) }}">{{ relation.name }}</a></li>
      {% endfor %}
  </ul>
  <div class="all-articles" data-swiftype-index="false">
    <a href="{{ url('articles') }}"><strong>See all articles...</strong></a>
  </div>
</article>


{# DISQUS COMMENTS #}
{% if article.allow_comments && cms.additionalglobals.add_disqus_comments %}
  {% set disqusName = cms.additionalglobals.disqus_shortname %}
  <div id="disqus_thread" itemscope "https://schema.org/UserComments"></div>
    <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES * * */
      var disqus_shortname = '{{disqusName}}';
      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
{% endif %}  
{% endblock %}

{% block scripts_extra %}
{% parent %}
<script>
 window.onscroll = headerFadeOnScroll;
    // window.addEventListener('scroll', stickySocialBar, false);
    /*HEADER FADES IN AND OUT ON SCROLL*/
    function headerFadeOnScroll() {
        var theHeader = document.getElementsByTagName('header')[0],
            theSiteName = document.querySelector('.site-name'),
            headerHeight = parseInt(theHeader.clientHeight);
        wScrollCurrent = window.pageYOffset | document.body.scrollTop;
        wScrollDiff = wScrollBefore - wScrollCurrent;
        if (wScrollCurrent <= headerHeight) {
            theHeader.classList.remove('hide-header');
            theSiteName.classList.remove('hide-header');
        } else if (wScrollDiff > 0) {
            theHeader.classList.remove('hide-header');
            theSiteName.classList.remove('hide-header');
        } else if (wScrollDiff < 0) {
            theHeader.classList.add('hide-header');
            theSiteName.classList.add('hide-header');
        }
        wScrollBefore = wScrollCurrent;
    }
</script>
{% endblock %}

